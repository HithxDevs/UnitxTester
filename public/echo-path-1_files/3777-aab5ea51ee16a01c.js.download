"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3777],{17685:(e,t,a)=>{a.d(t,{G:()=>m,k:()=>c});var l=a(67933),n=a(27338),i=a(60095),r=a(78435),s=a(34991),o=a(32417);let u=new Set([o.iC.FREE,o.iC.TOP_UP]),d=async()=>{let e=await r.U.getTokenCount(),t=e.data.tokens.filter(e=>{let{plan_id:t}=e;return u.has(t)}).reduce((e,t)=>e+t.balance,0);return{...e.data,nonSubscriptionTotal:t}},c=()=>{let{user:e}=(0,i.u)();return(0,l.I)({queryKey:[s.D.TOKEN_COUNT],staleTime:n.K2,queryFn:d,enabled:!!e})},m=()=>(0,l.I)({queryKey:[s.D.TOKEN_CONSUMPTION_CONFIG],staleTime:n.K2,queryFn:()=>r.U.getTokenConsumptionConfig()})},32417:(e,t,a)=>{a.d(t,{h1:()=>u,iC:()=>n,rq:()=>s,ss:()=>o,w1:()=>m,zM:()=>g});var l=a(79536);let n={FREE:0,SUBSCRIPTION:1,TOP_UP:2},i=l.KC([l.eu(n.FREE),l.eu(n.SUBSCRIPTION),l.eu(n.TOP_UP)]),r=l.Ik({balance:l.ai(),plan_id:i}),s=l.Ik({total:l.ai(),tokens:l.YO(r)}),o=l.Ik({tokens:l.ai()}),u=l.g1(l.Yj(),l.Yj()),d=l.Ik({code:l.Yj(),expected:l.Yj(),message:l.Yj(),path:l.YO(l.Yj()),received:l.Yj()});l.Ik({errors:l.YO(d)});let c=l.Ik({credits:l.ai(),feature:l.Yj(),start_time:l.Yj(),style_id:l.ai()}),m=l.Ik({usage:l.YO(c)}),p=l.Ik({credits:l.ai(),feature:l.Yj(),id:l.ai(),created_at:l.p6(),source_id:l.ai().nullable(),style_id:l.ai()}),g=l.Ik({credit_history:l.YO(p)})},34991:(e,t,a)=>{a.d(t,{D:()=>l});let l={TOKEN_COUNT:"token-count",TOKEN_CONSUMPTION_CONFIG:"token-consumption-config"}},54388:(e,t,a)=>{a.d(t,{U:()=>d});var l=a(7620),n=a(60095),i=a(66238),r=a(74729),s=a(17685),o=a(96450),u=a(53605);let d=()=>{var e,t,a,d,c;let{page:m,source:p}=(0,r.lN)(),{user:g}=(0,n.u)(),{data:f}=(0,s.k)(),{stripeSubscription:k,isSubscriptionActive:h}=(0,u.c)(),_=null!=(d=null==k||null==(t=k.StripePrice)||null==(e=t.StripeProduct)?void 0:e.name)?d:i.k.FREE,v=null!=(c=null==k||null==(a=k.StripePrice)?void 0:a.billingInterval)?c:i.k.FREE,I=h?i.k.PREMIUM:i.k.FREE,E=(0,o.Q)(()=>{var e,t,a;return{page:m||"None",source:p||"None",userStatus:I,userPlan:_,userPlanPeriod:v,name:null!=(e=null==g?void 0:g.name)?e:"",email:null!=(t=null==g?void 0:g.email)?t:"",id:null==g?void 0:g.id,tokenRemaining:null!=(a=null==f?void 0:f.total)?a:0}});return{computeUserAnalyticsInfo:(0,l.useCallback)(()=>E.current(),[E])}}},66238:(e,t,a)=>{a.d(t,{k:()=>l});let l={FREE:"Free",PREMIUM:"Premium"}},74729:(e,t,a)=>{a.d(t,{lN:()=>g,os:()=>p});var l=a(54568),n=a(62942),i=a(7620),r=a(60357),s=a(18010),o=a(66238),u=a(96450),d=a(53605),c=a(99588);let m=(0,i.createContext)(null),p=e=>{var t,a,p,g,f;let{children:k}=e,[h,_]=(0,i.useState)(""),[v,I]=(0,i.useState)(""),E=(0,n.usePathname)(),j=(0,r.DE)(),{aggregator:x}=(0,c.p)(),{stripeSubscription:y,isSubscriptionActive:C}=(0,d.c)(),N=null!=(g=null==y||null==(a=y.StripePrice)||null==(t=a.StripeProduct)?void 0:t.name)?g:o.k.FREE,P=null!=(f=null==y||null==(p=y.StripePrice)?void 0:p.billingInterval)?f:o.k.FREE,b=C?o.k.PREMIUM:o.k.FREE;(0,i.useEffect)(()=>{var e;j&&_(null!=(e=sessionStorage.getItem("source"))?e:"")},[j]);let w=(0,u.Q)(e=>{_(v),v&&sessionStorage.setItem("source",v),"/"===e&&(e="/landing-page"),I(e),x.log(s.M.pageView.withProperties({page_name:e,source:v,user_account_status:b,user_plan:N,user_plan_period:P}))});(0,i.useEffect)(()=>{w.current(E)},[E,w]);let T=(0,i.useMemo)(()=>({source:h,page:v}),[h,v]);return(0,l.jsx)(m.Provider,{value:T,children:k})},g=()=>{let e=(0,i.useContext)(m);if(null===e)throw Error("useHistoryContext must be used within a HistoryProvider");return e}},78435:(e,t,a)=>{a.d(t,{U:()=>k,N:()=>f});var l=a(89329),n=a(59051),i=a(32417),r=a(79536);let s=r.Ik({url:r.Yj(),base:r.ai().default(0),formula:r.Yj().optional(),formulas:r.E$(r.g1(r.Yj(),r.Ik({formula:r.Yj(),criteria:r.Ik({resolution:r.g1(r.Yj(),r.ai()).optional().default({}),duration:r.g1(r.Yj(),r.ai()).optional().default({})}).optional()})).optional(),r.Ik({_:r.Ik({formula:r.Yj()})})).default({_:{formula:""}}),criteria:r.Ik({style_id:r.E$(r.g1(r.Yj(),r.ai()).optional(),r.Ik({_:r.ai().optional().default(0)})).default({_:0})}).default({style_id:{_:0}})}),o=r.g1(r.Yj(),s),u=i.w1,d=i.zM,c=i.h1;class m{async getTokenCount(){let{requestOptions:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=await this._client.get("/credit",null!=e?e:void 0),a=(0,n.b)(i.rq,t.data);return{...t,data:a}}async getTokenConsumptionConfig(){let{requestOptions:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=await this._client.get("/cost",null!=e?e:void 0),a=(0,n.b)(o,t.data);return{...t,data:a}}async getReferralTokenCount(){let{headers:e,requestOptions:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=await this._client.get("/referral/info",{...null!=t?t:{},headers:e}),l=(0,n.b)(i.ss,a.data);return{...a,data:l}}async uploadFiles(e){let{files:t,signal:a}=e,l=new FormData;t.forEach(e=>{l.append("file",e,e.name)});let i=await this._client.post("/client/upload",l,{signal:a,headers:{"Content-Type":"multipart/form-data"}}),r=(0,n.b)(c,i.data);return{...i,data:r}}async getTokenUsageConsumption(e){let{startDate:t,endDate:a,requestOptions:l}=e,i=new URLSearchParams({startTime:null!=t?t:""});a&&i.append("endTime",a);let r=await this._client.get("/credit/consumption?".concat(i.toString()),null!=l?l:void 0),s=(0,n.b)(u,r.data);return{...r,data:s}}async getTokenUsageHistory(e){let{startDate:t,endDate:a,lastPage:l,limit:i=50,requestOptions:r}=e,s=new URLSearchParams({startTime:null!=t?t:"",limit:i.toString()});a&&s.append("endTime",a),(null==l?void 0:l.id)&&(s.append("fromId",l.id.toString()),s.append("from",l.created_at.toString()));let o=await this._client.get("/credit/history?".concat(s.toString()),null!=r?r:void 0),u=(0,n.b)(d,o.data);return{...o,data:u}}constructor({client:e}){this._client=e}}var p=a(48164),g=a(17643);let f=(0,p.d)(l.A.create({baseURL:g.h.NEXT_PUBLIC_ANPU_API_URL})),k=new m({client:f})},96578:(e,t,a)=>{a.d(t,{i:()=>o});var l=a(54568);a(7620);var n=a(51785),i=a(54140),r=a(33029),s=a(19603);let o=(0,n.F)(e=>{let{call:t,title:a,description:n,onConfirm:o=()=>Promise.resolve(),onCancel:u=()=>Promise.resolve(),cancelButtonText:d="Cancel",confirmButtonText:c="Continue",variant:m="primary",disableConfirmButton:p=!1,disableCancelButton:g=!1}=e;return(0,l.jsx)(r.lG,{defaultOpen:!0,children:(0,l.jsxs)(r.Cf,{onInteractOutside:()=>{t.end(!1)},className:"bg-background ring-border-primary rounded-4 size-full max-h-[min(calc(100vh-424px),176px)] max-w-[min(calc(100vw-24px),460px)] flex-col items-end gap-0 ring-1 drop-shadow-sm",children:[(0,l.jsxs)(r.c7,{className:"flex items-center justify-between self-stretch border-none p-3 pb-2 pl-4",children:[a&&(0,l.jsx)(r.L3,{className:"text-label-xl text-content-primary font-medium",children:a}),(0,l.jsx)(s.s,{children:(0,l.jsxs)(r.rr,{children:["Confirmation modal for ",a||"action"]})}),(0,l.jsx)(r.De,{})]}),(0,l.jsxs)(r.R4,{className:"flex flex-col items-start justify-between gap-4 self-stretch p-4 pt-2",children:[n&&(0,l.jsx)("p",{className:"text-body-md text-content-secondary",children:n}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2 self-stretch",children:[(0,l.jsx)(i.$,{size:"md",variant:"outline",className:"w-[120px]",onClick:async()=>{await u(),t.end(!1)},disabled:g,children:d}),(0,l.jsx)(i.$,{size:"md",variant:m,className:"w-[120px]",onClick:async()=>{await o(),t.end(!0)},disabled:p,children:c})]})]})]})})})}}]);