(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2553],{20526:(e,t,a)=>{Promise.resolve().then(a.bind(a,64007))},54504:(e,t,a)=>{"use strict";a.d(t,{I:()=>N});var r=a(16258),n=a(38),s=a(20364),l=a(81789),o=a(74342),i=a(3711),d=a(53605),c=a(25868),m=a(87606),u=a(65304),p=a(2584),h=a(7528),x=a(70727),g=a(14588),j=a(13402),v=a(85121),f=a(75567),b=a(81905),I=a(91260);let N=()=>{let e=(0,i.P)(),t=(()=>{let e=(0,m.jE)(),{vagErrorHandler:t}=(0,I._)();return(0,r.n)({mutationKey:[l.S.IMAGE_GENERATION_ASYNC],mutationFn:e=>g.d.generateImageAsync(e),onMutate:async t=>{var a;let r=null!=(a=t.metadata.placeholderUuid)?a:(0,u.g)(),n=(0,f.N)(t,r);for(let t of b.Q)e.getQueryData(t)&&e.setQueryData(t,e=>"data"in e?{...e,data:{...e.data,assets:[...n,...e.data.assets]}}:e.pages[0]?{...e,pages:[{...e.pages[0],data:{...e.pages[0].data,assets:[...n,...e.pages[0].data.assets]}},...e.pages.slice(1)]}:e);return{placeholderUuid:r}},onSuccess:(a,r,n)=>{let s=a.data.filter(e=>e.status===p.R.ERROR),l=a.data.length-s.length;for(let e=0;e<l;e++)(0,j.d)();if(s.length>0&&(null==n?void 0:n.placeholderUuid)){for(let t of b.Q)e.getQueryData(t)&&e.setQueryData(t,e=>"data"in e?{...e,data:{...e.data,assets:(0,v.z)({oldAssets:e.data.assets,placeholderUuid:n.placeholderUuid,removeAll:!1,errorCount:s.length})}}:e.pages[0]?{...e,pages:e.pages.map((e,t)=>0===t?{...e,data:{...e.data,assets:(0,v.z)({oldAssets:e.data.assets,placeholderUuid:n.placeholderUuid,removeAll:!1,errorCount:s.length})}}:e)}:e);try{(0,h.e8)(s)}catch(e){t(e)}}},onError:(t,a,r)=>{if(t instanceof x.U&&(null==r?void 0:r.placeholderUuid))for(let a of b.Q)e.getQueryData(a)&&e.setQueryData(a,e=>"data"in e?{...e,data:{...e.data,assets:(0,v.z)({oldAssets:e.data.assets,placeholderUuid:r.placeholderUuid,errorCount:t.data.length,removeAll:!0})}}:e.pages[0]?{...e,pages:e.pages.map((e,a)=>0===a?{...e,data:{...e.data,assets:(0,v.z)({oldAssets:e.data.assets,placeholderUuid:r.placeholderUuid,errorCount:t.data.length,removeAll:!0})}}:e)}:e)}})})(),{data:a}=(0,c.rH)(),N=null==a?void 0:a.pages.flatMap(e=>{let{data:{assets:t}}=e;return t}),{isLegacyUser:E,activeStripePlanName:y}=(0,d.c)();return(0,r.n)({mutationKey:[l.S.IMAGE_GENERATION_ASYNC],mutationFn:async a=>{var r,l;let i=(null!=(r=null==N?void 0:N.filter(e=>(e.code===n.WX.PENDING||e.code===n.WX.PROCESSING)&&e.service===s.z1.IMAGE))?r:[]).length,d=E?8:null!=(l=null==e?void 0:e.image)?l:4;if(i+a.count>d)throw new o.h("Current plan limits ".concat(d," concurrent generations. ").concat("Unlimited"===y?"":"Upgrade to increase."));return await t.mutateAsync(a)}})}},64007:(e,t,a)=>{"use strict";a.d(t,{ImageGenerationPromptBox:()=>tc});var r=a(54568),n=a(71524),s=a(61938),l=a(64196),o=a(96450),i=a(25761);let d=e=>{let{children:t}=e,{imageGenerationForm:a}=(0,i.NT)();return(0,r.jsx)(l.lV,{...a,children:t})},c=()=>{let e=(0,s.xW)(),t=(0,o.Q)(e);if(!e)throw Error("useImageGenerationFormContext must be used within imageGenerationFormContextProvider");return{formHook:e,formHookRef:t}};var m=a(21812),u=a(73106),p=a(72136),h=a(66727),x=a(88988),g=a(81552),j=a(23263),v=a(62369);let f=()=>{let{formHook:e}=c(),{closeAllDialogsExcept:t}=(0,x.N)(),a=(0,s.FH)({control:e.control,name:"model"}).aspectRatio;return(0,r.jsx)(l.zB,{control:e.control,name:"aspectRatio",render:e=>{let{field:{value:n,onChange:s}}=e;return(0,r.jsxs)(u.hm,{value:n,onChange:s,children:[(0,r.jsxs)(u.HC,{onMouseEnter:()=>{t([h.D.IMAGE_MODEL_POPOVER,h.D.IMAGE_PRESET_DIALOG])},children:[(0,r.jsx)(p.I,{baseSize:16,aspectRatio:n,stroke:1.2,padding:1.33}),n]}),(0,r.jsxs)(u.i1,{className:"h-67.5",children:[(0,r.jsx)(u.f7,{children:"Aspect Ratio"}),a.map(e=>(0,r.jsxs)(u.sy,{value:e,children:[(0,r.jsx)(p.I,{baseSize:16,aspectRatio:e,stroke:1.2,padding:1.33}),(0,r.jsx)("span",{children:e})]},e))]})]})}})},b=()=>{let{formHook:e}=c(),t=(0,s.FH)({control:e.control,name:"model"}).aspectRatio;return(0,r.jsx)(j.kc,{children:(0,r.jsx)(g.m,{children:(0,r.jsx)(l.zB,{control:e.control,name:"aspectRatio",render:e=>{let{field:{value:a,onChange:n}}=e;return(0,r.jsx)("div",{className:"tablet:grid-cols-5 grid grid-cols-4 gap-x-2 gap-y-3",children:Object.values(t).map(e=>{let t=a===e;return(0,r.jsxs)("button",{"data-state":t?"checked":"unchecked",onClick:()=>{n(e)},className:"group flex cursor-pointer flex-col items-center justify-center gap-2 disabled:cursor-not-allowed",children:[(0,r.jsx)("div",{className:"group-data-[state=checked]:ring-border-inverse rounded-2 group-data-[state=checked]:bg-fill-secondary-variant-hover bg-fill-secondary-variant group-hover:bg-fill-secondary-variant-hover text-content-tertiary group-data-[state=checked]:text-content-primary group-disabled:bg-fill-secondary-variant-disabled flex aspect-square w-full items-center justify-center p-7 transition-all ring-inset group-data-[state=checked]:ring-1",children:(0,r.jsx)(p.I,{aspectRatio:e,baseSize:24,stroke:1.5,padding:1.33})}),(0,r.jsx)("span",{className:"text-label-md text-content-secondary group-disabled:text-content-primary-disabled font-medium",children:e})]},e)})})}})})})},I=()=>{let{formHook:e}=c(),t=(0,s.FH)({control:e.control,name:"aspectRatio"});return(0,r.jsxs)(v.NT,{children:[(0,r.jsx)(v.J$,{children:"Aspect Ratio"}),(0,r.jsx)(v.zR,{screen:{name:"Aspect Ratio",component:(0,r.jsx)(b,{})},label:t,icon:(0,r.jsx)(p.I,{baseSize:16,aspectRatio:t,stroke:1.1,padding:2.2})})]})};var N=a(7620),E=a(3397),y=a(3476),_=a(98357),A=a(17685);let S=()=>{let{data:e}=(0,A.G)();return{computeImageGenerationCost:t=>{var a,r;let{modelId:n,numberOfImages:s}=t,l=null==e||null==(a=e.data)?void 0:a[_.X.GENERATE_IMAGE_ASYNC];if(!l)return{totalCost:0,modelCost:0,perImageCost:0};let o=l.base,i=null!=(r=l.criteria.style_id[n])?r:l.criteria.style_id._,d=o+i;return{totalCost:d*s,modelCost:i,perImageCost:d}}}};var O=a(68928),C=a(49896),w=a(16644),k=a(98805),M=a(4155);let R=e=>{let{modelId:t}=e,{modelCostColor:a}=(0,E.bO)(),{computeImageGenerationCost:n}=S(),{modelCost:s}=n({modelId:t,numberOfImages:1});return(0,r.jsx)(w.aM,{config:a.image,modelCost:s})},z=()=>{let{formHook:e}=c(),{searchForm:t}=(0,y.$A)(),{handleImageModelSelect:a}=(0,M.s)(),n=(0,s.FH)({control:e.control,name:"mode"}),l=(0,s.FH)({control:e.control,name:"model"}),{extractImageModelsForMode:o}=(0,m.M)(),i=(0,s.FH)({control:t.control,name:"searchQuery"}),d=o(n),{closeAllDialogs:u}=(0,O.I)(),p=i?d.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase())):d;return(0,r.jsx)(w.oo,{query:i,showEmpty:0===p.length,children:p.map(e=>{let t=e.id===l.id;return(0,r.jsx)(w.ff,{name:e.name,description:e.description,icon:e.icon,allowedPlans:e.allowedPlans,isSelected:t,onClick:()=>{a(e.modelId),u()},badges:[(0,r.jsx)(R,{modelId:e.modelId},"image-token-count")]},e.modelId)})})},P=()=>{let{isOpen:e,setDialogOpen:t,closeDialog:a,toggleDialog:n}=(0,C.s)(h.D.IMAGE_MODEL_POPOVER),{formHook:s}=c(),{closeAllDialogsExcept:o}=(0,x.N)();return(0,N.useEffect)(()=>{e&&o([h.D.IMAGE_MODEL_POPOVER])},[e,o]),(0,r.jsxs)(y.YL,{children:[(0,r.jsx)(l.zB,{control:s.control,name:"model",render:t=>{let{field:{value:a}}=t;return(0,r.jsx)(w.kI,{icon:a.icon,name:a.name,onClick:n,isOpen:e})}}),(0,r.jsx)(k.vF,{open:e,onOpenChange:t,children:(0,r.jsxs)(k.KZ,{children:[(0,r.jsx)(k.kX,{name:"Models",closePopover:a}),(0,r.jsx)("div",{className:"size-full overflow-hidden px-4",children:(0,r.jsx)(z,{})})]})})]})},T=()=>(0,r.jsx)(j.kc,{children:(0,r.jsx)(y.YL,{children:(0,r.jsx)(z,{})})}),G=()=>{let{formHook:e}=c(),t=(0,s.FH)({control:e.control,name:"model"});return(0,r.jsxs)(v.NT,{children:[(0,r.jsx)(v.J$,{children:"Models"}),(0,r.jsx)(v.zR,{screen:{name:"Models",component:(0,r.jsx)(T,{}),metadata:{className:"h-[calc(100dvh---spacing(20)))]"}},label:t.name,icon:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:t.icon}})})]})};var D=a(71140),L=a(31994);let U=()=>{let{formHook:e}=c(),{closeAllDialogsExcept:t}=(0,x.N)();return(0,r.jsx)(l.zB,{control:e.control,name:"numberOfImages",render:e=>{var a,n;let{field:{value:s,onChange:l}}=e;return(0,r.jsxs)(u.hm,{value:"".concat(s),onChange:e=>l(Number(e)),children:[(0,r.jsxs)(u.HC,{onMouseEnter:()=>{t([h.D.IMAGE_MODEL_POPOVER,h.D.IMAGE_PRESET_DIALOG])},children:[null==(a=L.Q[s])?void 0:a.icon,null==(n=L.Q[s])?void 0:n.ctaLabel]}),(0,r.jsxs)(u.i1,{children:[(0,r.jsx)(u.f7,{children:"Variations"}),Object.values(L.Q).map(e=>{let{icon:t,label:a,value:n}=e;return(0,r.jsxs)(u.sy,{value:"".concat(n),children:[t,(0,r.jsx)("span",{children:a})]},n)})]})]})}})},F=()=>{let{formHook:e}=c();return(0,r.jsx)(j.kc,{children:(0,r.jsx)(g.m,{children:(0,r.jsx)(l.zB,{control:e.control,name:"numberOfImages",render:e=>{let{field:{value:t,onChange:a}}=e;return(0,r.jsx)("div",{className:"flex flex-col items-stretch gap-1",children:Object.values(L.Q).map(e=>{var n;let{label:s,value:l}=e,o=t===l;return(0,r.jsxs)("button",{"data-state":o?"checked":"unchecked",onClick:()=>{a(l)},className:"group text-content-secondary disabled:text-content-primary-disabled rounded-2.5 hover:bg-fill-primary-variant-hover flex cursor-pointer items-center justify-between p-3.5 pl-2.5 transition-colors **:[svg]:size-5 **:[svg]:stroke-[1.5]",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[null==(n=L.Q[l])?void 0:n.icon,(0,r.jsx)("span",{className:"text-label-lg",children:s})]}),o&&(0,r.jsx)(D.Srz,{className:"stroke-[1.5]"})]},l)})})}})})})},H=()=>{var e,t,a;let{formHook:n}=c(),l=(0,s.FH)({control:n.control,name:"numberOfImages"});return(0,r.jsxs)(v.NT,{children:[(0,r.jsx)(v.J$,{children:"Variations"}),(0,r.jsx)(v.zR,{screen:{name:"Variations",component:(0,r.jsx)(F,{})},label:null!=(a=null==(e=L.Q[l])?void 0:e.label)?a:"".concat(l," Images"),icon:null==(t=L.Q[l])?void 0:t.icon})]})},V=()=>{let{formHook:e}=c(),t=(0,s.FH)({control:e.control,name:"mode"}),{extractImageModelsForMode:a}=(0,m.M)(),n=a(t);return(0,r.jsxs)("div",{className:"laptop:flex hidden items-center gap-2",children:[n.length>1&&(0,r.jsx)(P,{}),(0,r.jsx)(f,{}),(0,r.jsx)(U,{})]})};var K=a(27764),Q=a(53605),$=a(91260),B=a(6737),Y=a(25970),W=a(65304),X=a(88796),J=a(44709),q=a(61744),Z=a(54504),ee=a(82832),et=a(63977),ea=a(2899),er=a(2584),en=a(18010),es=a(22625),el=a(22282),eo=a(54388),ei=a(99588),ed=a(94290),ec=a(38727);let em=e=>{let{children:t}=e,{formHook:a}=c(),s=(()=>{let{imagePromptEnhancerId:e}=(0,E.bO)();return(0,N.useCallback)(async t=>{var a,r,n,s;let l=t.prompt;if(0===t.model.presets.length&&t.mode!==q.K.IMAGE_PROMPT&&!t.prompt)throw Error("Prompt is required");if(t.prompt.length>J.A.IMAGE_PROMPT)throw Error("Prompt is too long, please keep it under ".concat(J.A.IMAGE_PROMPT," characters. You have ").concat(t.prompt.length," characters"));if(t.mode!==q.K.IMAGE_PROMPT){let e=t.images.length;if(!(e>=t.model.minImages&&e<=t.model.maxImages)){if(0===t.model.maxImages)throw Error("You can't upload any images for the selected model");if(t.model.minImages===t.model.maxImages)throw Error("You must upload ".concat(t.model.minImages," ").concat(1===t.model.minImages?"image":"images"," for the selected model"));throw Error("You must upload between ".concat(t.model.minImages," and ").concat(t.model.maxImages," ").concat(1===t.model.maxImages?"image":"images"," for the selected model"))}}else if(0===t.images.length)throw Error("You must upload at an image to use image prompt");let o=[],i=async e=>{let{aspectRatio:t,image:a}=e,r=await (0,B.je)(a);return(0,Y.y)({imageBlob:r,aspectRatio:t})},d=(o=await Promise.all(t.images.map(e=>{let{src:a}=e;return i({image:a,aspectRatio:t.aspectRatio})}))).length>0?X.Ej.IMAGE_TO_IMAGE:X.Ej.TEXT_TO_IMAGE;t.mode===q.K.IMAGE_PROMPT&&(d=X.Ej.TEXT_TO_IMAGE);let c=(0,W.g)(),m=[t.prompt];(null==(a=t.preset)?void 0:a.prompt)&&m.push(null==(r=t.preset)?void 0:r.prompt);let u={prompt:m.join(", "),styleId:t.model.modelId,aspectRatio:t.aspectRatio,count:t.numberOfImages,variation:d,isEnhance:t.model.isEnhance,...t.mode===q.K.IMAGE_PROMPT?{enhancerId:e}:t.mode===q.K.STYLE_REFERENCE?{pluginName:t.model.enhancerId,enhancerId:void 0}:{enhancerId:t.model.isEnhance?t.model.enhancerId:void 0},metadata:{placeholderUuid:c,promptWithoutManipulation:l,presetId:(null==(n=t.preset)?void 0:n.id)?"".concat(null==(s=t.preset)?void 0:s.id):void 0},images:o};return t.baseUuid&&(u.base=t.baseUuid),t.batchUuid&&(u.batch=t.batchUuid),u},[e])})(),{fireImageGenerationEvent:l}=(()=>{let{aggregator:e}=(0,ei.p)(),{computeUserAnalyticsInfo:t}=(0,eo.U)(),{data:a}=(0,A.k)();return{fireImageGenerationEvent:r=>{var n,s,l;let{error:o,formValues:i,generateImageAsyncDTO:d}=r,c=d?d.reduce((e,t)=>{var a;return t.status===er.R.SUCCESS?e+(null!=(a=t.cost)?a:0):e},0):0,m=null!=(s=null==a?void 0:a.total)?s:0,{page:u,userStatus:p,userPlan:h,userPlanPeriod:x,source:g,id:j,email:v}=t(),f=(0,ea.$)(i.prompt),b={upload_image:i.images.length>0,aspect_ratio:i.aspectRatio,number_of_images:i.numberOfImages,model_used:i.model.name,presets:null!=(l=null==(n=i.preset)?void 0:n.name)?l:"",image_mode:i.mode,prompt_text:f.promptText1,prompt_text_2:f.promptText2,prompt_text_3:f.promptText3,upscale_used:!1,variate_used:!1,upload_type:i.imageUploadType?ec.r[i.imageUploadType]:el.Q,recreate:!1,inspiration_used:!1,page_name:u,source:g,user_account_status:p,user_plan:h,user_plan_period:x,distinct_id:j,email:v,tokens_remaining:m-c,tokens_consumed:c};if(null==o)return void e.log(en.M.imageGenerationOne.withProperties({...b,processing_status:es.n.SUCCESSFUL}));e.log(en.M.imageGenerationOne.withProperties({...b,processing_status:es.n.FAILED,processing_error:(0,ed.n)(o)}))}}})(),{closeAllDialogs:o}=(0,O.I)(),i=(0,Z.I)(),{isGenerating:d,setIsGenerating:m}=(0,n.Iq)(),{vagErrorHandler:u}=(0,$._)(),{activeStripePlanName:p}=(0,Q.c)();return(0,r.jsx)("form",{className:"pointer-events-auto block",onSubmit:a.handleSubmit(async e=>{if(o(),!d){m(!0);try{if(!(0,K.N)(e.model.allowedPlans,p)){var t;let a=(0,et.q)(null!=(t=e.model.allowedPlans)?t:[]);throw new ee.P("Upgrade your plan to ".concat(a," to use this model"))}let r=await s(e);m(!1),a.getValues("shouldRetainPrompt")||a.setValue("prompt",""),a.setValue("shouldRetainPrompt",!1);let n=await i.mutateAsync(r);l({error:null,formValues:e,generateImageAsyncDTO:n.data})}catch(t){u(t),l({error:t,formValues:e,generateImageAsyncDTO:null})}finally{m(!1)}}}),children:t})};var eu=a(1640),ep=a(68785),eh=a(61773),ex=a(40417),eg=a(51874),ej=a(13146),ev=a(54140),ef=a(98720),eb=a(53513),eI=a(10987),eN=a(11386),eE=a(65338),ey=a(94363),e_=a(78848),eA=a(20870),eS=a(93107),eO=a(69190),eC=a(40515),ew=a(76375),ek=a(38134);let eM=e=>{let{onImageUpload:t}=e;return(0,r.jsx)(ex.Ay,{noClick:!0,onDropAccepted:e=>{let a=e[0];a?t(a):eg.oR.error("No file selected")},onDropRejected:e=>{var t,a;(null==(a=e[0])||null==(t=a.errors[0])?void 0:t.code)==="file-too-large"?eg.oR.error("File is bigger than 5MB"):eg.oR.error("An error occurred while uploading the file")},accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"image/webp":[".webp"]},maxSize:5242880,maxFiles:1,children:e=>{let{getRootProps:t,getInputProps:a,isDragAccept:n}=e;return(0,r.jsxs)("label",{...t(),className:"border-border-secondary rounded-4 bg-surface-primary-variant hover:border-border-tertiary data-[drag-accept=true]:border-border-brand data-[drag-accept=true]:bg-surface-brand block h-45 w-full shrink-0 cursor-pointer border-1 border-dashed","data-drag-accept":n,children:[(0,r.jsx)("input",{...a()}),(0,r.jsxs)("div",{className:"flex size-full flex-col items-center justify-center gap-3",children:[(0,r.jsx)(D.Oc1,{className:"text-content-primary size-6 stroke-[1.5]"}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,r.jsxs)("div",{className:"text-content-secondary text-label-md flex flex-wrap items-center justify-center gap-1.5 font-medium",children:[(0,r.jsx)("span",{children:"Click to upload"}),(0,r.jsx)("svg",{width:"7",height:"18",viewBox:"0 0 7 18",fill:"none",className:"text-content-tertiary max-tablet:hidden",children:(0,r.jsx)("path",{d:"M5.875 1L1.125 17",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),(0,r.jsx)("span",{className:"max-tablet:hidden",children:"drag & drop"})]}),(0,r.jsx)("span",{className:"text-content-tertiary text-label-sm text-center",children:"JPG, PNG, WEBP file, up to 5MB"})]})]})]})}})},eR=e=>{let{onClose:t,selectedImageIndex:a,onSelectedImageDelete:n}=e,{formHook:l}=c(),{vagErrorHandler:o}=(0,$._)(),{initiateImageLoading:i,finishLoading:d}=(0,ek.O)(),m=(0,eA.d)(),{handleAddImage:u}=(0,eC.Y)({onSettle:t}),{handleImageDelete:p}=eq(),h=(0,s.FH)({control:l.control,name:"images"}),x=(e,r)=>{let n=(0,W.g)(),s=[...h];return s[a]={id:(0,W.g)(),src:e,thumbnailSrc:r},l.setValue("images",s),t(),n},j=async e=>{l.setValue("imageUploadType",ec.R.NEW);let t="",r="";try{r=URL.createObjectURL(e),t=-1===a?u(r,r):x(r,r),i(t);let n=await (0,Y.j7)({imgBlob:e}),{height:s,width:o}=await (0,Y.rt)({imgBlob:e}),{data:d}=await m.mutateAsync({file:e,title:(0,W.g)(),thumbnail:n,metadata:{width:o,height:s}}),c=l.getValues("images"),p=c.findIndex(e=>e.id===t);-1!==p&&(URL.revokeObjectURL(r),c[p]={id:t,src:d.url,thumbnailSrc:d.url},l.setValue("images",c))}catch(e){if(-1!==a)p(a);else{let e=l.getValues("images"),a=e.findIndex(e=>e.id===t);-1!==a&&(e.splice(a,1),l.setValue("images",e))}URL.revokeObjectURL(r),o(e)}finally{d(t)}};return(0,r.jsx)("div",{className:"flex size-full flex-col items-stretch gap-4 overflow-hidden",children:(0,r.jsxs)(g.m,{className:"flex flex-col items-stretch gap-2",children:[(0,r.jsx)("div",{className:"pt-2 pb-4",children:-1===a?(0,r.jsx)(eM,{onImageUpload:j}):(0,r.jsx)(ez,{selectedImageIndex:a,onSelectedImageDelete:n})}),(0,r.jsx)(eO.y,{onSelect:(e,t)=>{l.setValue("imageUploadType",ec.R.RECENT),-1===a?u(e,t):x(e,t)}})]})})},ez=e=>{let{selectedImageIndex:t,onSelectedImageDelete:a}=e,{formHook:n}=c(),l=(0,s.FH)({control:n.control,name:"images"})[t];return l?(0,r.jsxs)("div",{className:"rounded-4 relative h-45 w-full shrink-0",children:[(0,r.jsx)("img",{src:l.src,alt:"Selected",className:"rounded-4 absolute inset-1 size-[calc(100%-4px)] object-cover object-center"}),(0,r.jsx)("div",{className:"bg-surface-primary-variant/80 rounded-4 absolute inset-0 backdrop-blur-md"}),(0,r.jsx)(eh.default,{src:l.src,alt:"Selected",fill:!0,className:"object-contain object-center"}),(0,r.jsx)(ev.$,{size:"icon-xs",variant:"img-hover-cta",className:"absolute top-2 right-2",onClick:a,children:(0,r.jsx)(D.ucK,{className:"stroke-[1.5]"})})]}):null},eP=e=>{var t,a;let{image:n,isSelected:s,onSelect:l,onDelete:o,className:i}=e,d=(0,ek.O)(e=>e.getLoadingState)(null!=(t=null==n?void 0:n.id)?t:""),c=!s&&!d,{isOpen:m}=eq();return(0,r.jsx)(eG,{image:null!=(a=null==n?void 0:n.src)?a:"",disabled:m,thumbnail:null==n?void 0:n.thumbnailSrc,children:(0,r.jsxs)("div",{"data-state":s?"open":"closed",className:(0,eN.cn)("group/image-item relative isolate h-18 w-13.5 shrink-0 transition-transform data-[state=open]:-translate-y-3.5 data-[state=open]:scale-110",{"hover:-translate-y-2 hover:scale-110 hover:-rotate-15":!s&&!d,"rotate-0!":s},i),children:[c&&(0,r.jsx)(ev.$,{variant:"none",size:"none",className:"bg-fill-secondary pointer-events-none invisible absolute -top-1 -left-1 z-1 inline-flex size-5 items-center justify-center rounded-full opacity-0 transition-opacity group-hover/image-item:pointer-events-auto group-hover/image-item:visible group-hover/image-item:opacity-100",onClick:o,children:(0,r.jsx)(D.w0d,{className:"size-3"})}),(0,r.jsxs)(ev.$,{variant:"none",size:"none",className:"border-border-primary bg-fill-primary-variant group-hover/image-item:border-border-primary-hover group-hover/image-item:bg-fill-primary-variant-hover rounded-2.5 group-data-[state=open]/image-item:border-content-primary group-data-[state=open]/image-item:bg-fill-primary-variant-hover relative flex size-full items-center justify-center overflow-hidden border-1 transition-all will-change-transform",onClick:l,disabled:d,children:[d&&(0,r.jsx)("div",{className:"bg-content-fixed-inverse/30 absolute inset-0 z-2 flex items-center justify-center",children:(0,r.jsx)(eI.Spinner,{className:"size-6"})}),(0,r.jsx)(eh.default,{src:n.thumbnailSrc,alt:"Uploaded",fill:!0,className:"object-cover object-center"},n.id)]})]})})},eT=e=>{let{onAdd:t,isOpen:a,className:n,feature:s}=e,{setNodeRef:l,isOver:o,active:i}=(0,ep.zM)({id:eS.CU,data:{feature:s}});return(0,r.jsx)(eL,{children:(0,r.jsx)(ev.$,{variant:"none",size:"none","data-state":a?"open":"closed",className:(0,eN.cn)("border-border-primary bg-fill-primary-variant rounded-2.5 data-[state=open]:border-content-primary data-[state=open]:bg-fill-primary-variant-hover flex h-18 w-13.5 shrink-0 translate-y-0 items-center justify-center overflow-hidden border-1 transition-all will-change-transform data-[state=open]:-translate-y-3.5 data-[state=open]:scale-110",{"border-border-brand bg-surface-brand border-dashed":o,"hover:border-border-primary-hover hover:bg-fill-primary-variant-hover":!i},n),onClick:t,ref:l,children:(0,r.jsx)(eE.w,{})})})},eG=e=>{let{children:t,disabled:a,image:n,thumbnail:s}=e,l=(0,e_.d)(),{isDragging:o}=(0,ew.p)();return(0,r.jsxs)(eb.m_,{open:!0!==a&&!!l&&!o&&void 0,delayDuration:1e3,children:[(0,r.jsx)(eb.k$,{asChild:!0,children:t}),(0,r.jsxs)(eb.ZI,{sideOffset:20,className:"rounded-4 ring-border-inverse max-h-59 max-w-59 overflow-hidden p-0 ring-4",children:[(0,r.jsx)("img",{src:s,alt:"Preview Thumbnail",className:"rounded-3 z-0 size-full max-h-59 max-w-59 object-contain"}),(0,r.jsx)(eh.default,{src:n,alt:"Preview",fill:!0,className:"rounded-3 z-1 size-full max-h-59 max-w-59 object-cover"})]})]})},eD=()=>{var e,t,a;let{isOpen:n,watchImages:s,onSelectImage:l,handleImageDelete:o}=eq(),i=(0,ek.O)(e=>e.getLoadingState),d=s[0],c=i(null!=(e=null==d?void 0:d.id)?e:""),m=!n&&!c;return(0,r.jsx)(eG,{image:null!=(t=null==d?void 0:d.src)?t:"",disabled:n,thumbnail:null==d?void 0:d.thumbnailSrc,children:(0,r.jsxs)("div",{className:"group/image-item relative h-18 w-full shrink-0",children:[m&&(0,r.jsx)(ev.$,{variant:"none",size:"none",className:"bg-fill-secondary pointer-events-none invisible absolute -top-1 -left-1 z-1 inline-flex size-5 items-center justify-center rounded-full opacity-0 transition-opacity group-hover/image-item:pointer-events-auto group-hover/image-item:visible group-hover/image-item:opacity-100",onClick:()=>o(0),children:(0,r.jsx)(D.w0d,{className:"size-3"})}),(0,r.jsxs)(ev.$,{size:"none",variant:"none",type:"button",disabled:c,"data-state":n?"open":"closed",className:"group rounded-2.5 border-border-primary bg-fill-primary data-[state=open]:border-content-primary relative size-full cursor-pointer overflow-hidden border disabled:cursor-not-allowed",onClick:()=>l(0),children:[c&&(0,r.jsx)("div",{className:"bg-content-fixed-inverse/30 absolute inset-0 z-2 flex items-center justify-center",children:(0,r.jsx)(eI.Spinner,{className:"size-6"})}),(0,r.jsx)("div",{className:"absolute inset-0 overflow-hidden transition-all group-data-[state=open]:inset-[3px] group-data-[state=open]:rounded-[9px]",children:(0,r.jsx)(eh.default,{fill:!0,src:null!=(a=null==d?void 0:d.thumbnailSrc)?a:"",alt:"Uploaded ".concat(null==d?void 0:d.id),className:"object-cover object-center"})})]})]})})},eL=e=>{let{children:t}=e;return(0,r.jsxs)(eb.m_,{children:[(0,r.jsx)(eb.k$,{asChild:!0,children:t}),(0,r.jsx)(eb.ZI,{children:"Add Image"})]})},eU=e=>{let{feature:t}=e,{isOpen:a,toggleModal:n}=eq(),{setNodeRef:s,isOver:l,active:o}=(0,ep.zM)({id:eS.CU,data:{feature:t}});return(0,r.jsx)(eL,{children:(0,r.jsx)(ev.$,{variant:"none",size:"none","data-state":a?"open":"closed",className:(0,eN.cn)("border-border-primary rounded-2.5 data-[state=open]:border-content-primary data-[state=open]:bg-fill-primary-variant-hover flex h-18 items-center justify-center border-1",{"border-border-brand bg-surface-brand border-dashed":l,"hover:border-border-primary-hover hover:bg-fill-primary-variant-hover":!o}),onClick:n,ref:s,children:(0,r.jsx)(eE.w,{})})})},eF=()=>{let{watchImages:e,watchModel:t}=eq();return 0===e.length?(0,r.jsx)(eU,{feature:ey.j.IMAGE}):(1===t.maxImages||0===t.maxImages)&&1===e.length?(0,r.jsx)(eD,{}):t.maxImages>=2&&1===e.length||2===t.maxImages&&2===e.length?(0,r.jsx)(eH,{}):(0,r.jsx)(eV,{})},eH=()=>{let{isOpen:e,watchImages:t,selectedImageIndex:a,onSelectImage:n,handleImageDelete:s}=eq();return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[t.map((t,l)=>{let o=e&&a===l;return(0,r.jsx)(eP,{image:t,isSelected:o,onSelect:()=>{n(l)},onDelete:()=>s(l)},l)}),1===t.length&&(0,r.jsx)(eT,{feature:ey.j.IMAGE,isOpen:e&&-1===a,onAdd:()=>{n(-1)}})]})},eV=()=>{let{isOpen:e,watchImages:t,selectedImageIndex:a,onSelectImage:n,handleImageDelete:s,canHaveOnlyThreeImages:l,watchModel:o}=eq(),{maxImages:i}=o;return(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[t.map((t,o)=>{let i=e&&a===o;return(0,r.jsx)(eP,{image:t,isSelected:i,onSelect:()=>{n(o)},onDelete:()=>s(o),className:(0,eN.cn)("w-13 odd:rotate-3 even:-rotate-3",{"not-first:-ml-7.5":l,"not-first:-ml-10":!l})},o)}),t.length<i&&(0,r.jsx)(eT,{feature:ey.j.IMAGE,isOpen:e&&-1===a,onAdd:()=>{n(-1)},className:(0,eN.cn)("w-13",{"-ml-7.5":l,"-ml-10":!l})})]})},eK=()=>{let{isSingleItemSheetOpen:e,onOpenChange:t,selectedImageIndex:a,closeModal:n,handleSelectedImageDelete:s}=eq();return(0,r.jsx)(ef.Sheet,{open:e,onOpenChange:t,children:(0,r.jsxs)(j.zE,{className:"gap-0",children:[(0,r.jsx)(j.SJ,{name:"Add Image",description:"Upload an image or select from recent uploads",useCrossIcon:!0}),(0,r.jsx)(j.kc,{className:"pt-0",children:(0,r.jsx)(eR,{onClose:n,selectedImageIndex:a,onSelectedImageDelete:s})})]})})},eQ=()=>{let{handleImageDelete:e,watchImages:t,watchModel:a,closeModal:n}=eq(),{maxImages:s}=a,l=t.length<s,{push:o,pop:i}=(0,ej.N)();return(0,r.jsx)(j.kc,{className:"pt-0",children:(0,r.jsx)(g.m,{className:"flex flex-col items-stretch gap-2",children:(0,r.jsxs)("div",{className:"tablet:grid-cols-4 mobile-l:grid-cols-3 grid grid-cols-2 gap-2 pt-2 pb-4",children:[t.map((t,a)=>(0,r.jsxs)("div",{className:"relative isolate",children:[(0,r.jsx)(ev.$,{variant:"none",size:"none",className:"bg-fill-secondary absolute -top-1 -right-1 z-1 inline-flex size-5 items-center justify-center rounded-full",onClick:()=>{e(a)},children:(0,r.jsx)(D.w0d,{className:"size-3"})}),(0,r.jsx)(ev.$,{size:"none",variant:"none",className:"bg-fill-primary-variant rounded-2 relative aspect-square w-full overflow-hidden",onClick:()=>{o({name:"Update Image",component:(0,r.jsx)(j.kc,{className:"pt-0",children:(0,r.jsx)(g.m,{className:"flex flex-col items-stretch gap-2",children:(0,r.jsx)(eR,{onClose:n,selectedImageIndex:a,onSelectedImageDelete:()=>{e(a),i()}})})})})},children:(0,r.jsx)(eh.default,{src:t.thumbnailSrc,alt:"Uploaded",fill:!0,className:"object-cover object-center"})})]},a)),l&&(0,r.jsx)(ev.$,{variant:"none",size:"none",className:"border-border-primary hover:border-border-primary-hover hover:bg-fill-primary-variant-hover rounded-2.5 flex aspect-square w-full items-center justify-center border-1",onClick:()=>{o({name:"Add Image",component:(0,r.jsx)(j.kc,{className:"pt-0",children:(0,r.jsx)(g.m,{className:"flex flex-col items-stretch gap-2",children:(0,r.jsx)(eR,{onClose:n,selectedImageIndex:-1,onSelectedImageDelete:()=>{}})})})})},children:(0,r.jsx)(eE.w,{})})]})})})},e$=()=>{let{currentScreen:e}=(0,ej.N)();return null==e?void 0:e.component},eB=()=>{let{currentScreen:e,stack:t,pop:a}=(0,ej.N)(),n=t.length>1;return(0,r.jsxs)(ef.SheetHeader,{className:"bg-background tablet:pl-6 sticky top-0 z-10 h-13 py-1.5 pr-1.5 pl-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[n&&(0,r.jsx)(ev.$,{variant:"ghost",size:"icon-md",onClick:a,children:(0,r.jsx)(D.m_v,{})}),(0,r.jsx)(ef.SheetTitle,{children:null==e?void 0:e.name})]}),(0,r.jsx)(ef.SheetDescription,{className:"sr-only",children:null==e?void 0:e.name}),(0,r.jsx)(ef.SheetClose,{asChild:!0,children:(0,r.jsx)(ev.$,{variant:"ghost",size:"icon-md",children:(0,r.jsx)(D.w0d,{})})})]})},eY=()=>{let{isMultipleItemsSheetOpen:e,onOpenChange:t}=eq();return(0,r.jsx)(ef.Sheet,{open:e,onOpenChange:t,children:(0,r.jsx)(ef.SheetContent,{side:"bottom",className:"rounded-t-4 flex h-[min(--spacing(198),calc(100dvh---spacing(58)))] flex-col items-stretch gap-0 overflow-hidden",children:(0,r.jsxs)(ej.l,{initialStack:[{name:"Add Image",component:(0,r.jsx)(eQ,{})}],children:[(0,r.jsx)(eB,{}),(0,r.jsx)(e$,{})]})})})},eW=()=>{let{isPopoverOpen:e,onOpenChange:t,closeModal:a,selectedImageIndex:n,handleSelectedImageDelete:s}=eq();return(0,r.jsx)(k.vF,{open:e,onOpenChange:t,children:(0,r.jsxs)(k.KZ,{className:"[--settings-popover-height:--spacing(129)]",children:[(0,r.jsx)(k.kX,{name:"Add image",closePopover:a}),(0,r.jsx)("div",{className:"size-full overflow-hidden px-4",children:(0,r.jsx)(eR,{onClose:a,onSelectedImageDelete:s,selectedImageIndex:n})})]})})},eX=(0,N.createContext)(null),eJ=e=>{let{children:t}=e,{isOpen:a,setDialogOpen:n,closeDialog:l,toggleDialog:o,openDialog:i}=(0,C.s)(h.D.ADD_IMAGE_OPTION_MODAL),d=(0,e_.hM)(),{formHook:m}=c(),{imageMode:u}=(0,E.bO)(),p=(0,s.FH)({control:m.control,name:"model"}),g=(0,s.FH)({control:m.control,name:"images"}),{handleImageModelSelect:j}=(0,M.s)(),v=p.maxImages>1,f=3===p.maxImages||2===g.length,b=!d&&a,I=d&&a&&!v,y=d&&a&&v,[_,A]=(0,N.useState)(-1),S=e=>{let t=[...g];if(t.splice(e,1),0===t.length){m.setValue("mode",q.K.CREATE);let e=u[q.K.CREATE].models[0];e&&j(e.modelId)}m.setValue("images",t)},{closeAllDialogsExcept:O}=(0,x.N)();return(0,N.useEffect)(()=>{a&&O([h.D.ADD_IMAGE_OPTION_MODAL])},[a,O]),(0,r.jsx)(eX.Provider,{value:{isOpen:a,onOpenChange:n,toggleModal:o,closeModal:l,openModal:i,selectedImageIndex:_,onSelectImage:e=>{A(e),_===e?o():i()},handleSelectedImageDelete:()=>{S(_),A(-1)},handleImageDelete:S,isPopoverOpen:b,isSingleItemSheetOpen:I,isMultipleItemsSheetOpen:y,watchImages:g,watchModel:p,canHaveOnlyThreeImages:f},children:t})},eq=()=>{let e=(0,N.useContext)(eX);if(!e)throw Error("useAddImageOptionContext must be used within an AddImageOptionContextProvider");return e},eZ=()=>(0,r.jsxs)(eJ,{children:[(0,r.jsx)(eF,{}),(0,r.jsx)(eK,{}),(0,r.jsx)(eY,{}),(0,r.jsx)(eW,{})]}),e0=()=>{let{formHook:e}=c();return 0===(0,s.FH)({control:e.control,name:"images"}).length?null:(0,r.jsx)(eZ,{})},e1=()=>{let{isOpen:e,setDialogOpen:t,closeDialog:a}=(0,C.s)(h.D.PLUS_ICON_BUTTON_MODAL);return(0,r.jsxs)(ef.Sheet,{open:e,onOpenChange:t,children:[(0,r.jsx)(ef.SheetTrigger,{asChild:!0,children:(0,r.jsx)(ev.$,{variant:"none",size:"icon-md",className:"border-border-primary hover:border-border-primary-hover hover:bg-fill-primary-variant-hover tablet:hidden border-1",children:(0,r.jsx)(eE.w,{})})}),(0,r.jsxs)(j.zE,{className:"gap-0",children:[(0,r.jsx)(j.SJ,{name:"Add Image",description:"Upload an image or select from recent uploads",onBackClick:a}),(0,r.jsx)(j.kc,{className:"pt-0",children:(0,r.jsx)(eJ,{children:(0,r.jsx)(eR,{onClose:a,selectedImageIndex:-1,onSelectedImageDelete:()=>{}})})})]})]})};var e5=a(80498),e2=a(22554),e8=a(76448);let e3={[q.K.EDIT]:{ctaLabel:"Edit",icon:(0,r.jsx)(D.sET,{className:"stroke-[1.5]"}),canAcceptImages:!0},[q.K.CREATE]:{ctaLabel:"Add image",icon:(0,r.jsx)(D.Zes,{}),canAcceptImages:!1},[q.K.IMAGE_PROMPT]:{ctaLabel:"Prompt",icon:(0,r.jsx)(D.N$i,{className:"stroke-[1.5]"}),canAcceptImages:!0},[q.K.STYLE_REFERENCE]:{ctaLabel:"Style ref",icon:(0,r.jsx)(D.mvu,{className:"stroke-[1.2]"}),canAcceptImages:!0}};var e4=a(21517);let e7=()=>{let{modeOptions:e}=(0,E.bO)(),{formHook:t}=c(),a=(0,s.FH)({control:t.control,name:"mode"}),{isOpen:n,setDialogOpen:l,closeDialog:o}=(0,C.s)(h.D.IMAGE_SWITCH_MODE_BUTTON_MODAL),{handleImageModeSelect:i}=(0,e4.E)({onSelect:o}),d=(0,s.FH)({control:t.control,name:"model"}),m=e3[a].icon,u=e3[a].ctaLabel;return(0,r.jsxs)(ef.Sheet,{open:n,onOpenChange:l,children:[(0,r.jsx)(e8.dh,{icon:m,label:u}),(0,r.jsxs)(j.zE,{className:"h-100",children:[(0,r.jsx)(j.SJ,{name:"Mode",description:"Select a mode"}),(0,r.jsx)(j.kc,{children:(0,r.jsx)(g.m,{children:(0,r.jsx)("div",{className:"flex flex-col items-stretch gap-1",children:e.image.map(e=>{let t=a===e.mode&&(null==e.modelId||e.modelId===d.modelId);return(0,r.jsx)(e8.s_,{title:e.title,icon:e.icon,isSelected:a===e.mode&&null==e.modelId,badge:null==e.modelId?void 0:e.mode,onSelect:()=>{i(t?q.K.CREATE:e.mode,e.modelId)}},null==e.modelId?e.mode:"".concat(e.mode,"-").concat(e.modelId))})})})})]})]})},e6=e=>{let{onEscPress:t,onModeSelect:a,selected:n}=e,{modeOptions:l}=(0,E.bO)(),o=(0,N.useMemo)(()=>(0,e2.w)(l.image,3),[l.image]),{formHook:i}=c(),d=(0,s.FH)({control:i.control,name:"model"});return(0,N.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-background/1 pointer-events-none absolute inset-0 -z-1 blur-2xl backdrop-blur-xs"}),o.map((e,t)=>(0,r.jsx)("div",{className:"flex items-center gap-4",children:e.map((e,t)=>{if(!e)return(0,r.jsxs)(N.Fragment,{children:[(0,r.jsx)(eu.Separator,{orientation:"vertical",className:"min-h-5 opacity-0"}),(0,r.jsx)("div",{className:"pointer-events-none flex-1/3 grow opacity-0"})]},t);let s=n===e.mode&&(null==e.modelId||e.modelId===d.modelId);return(0,r.jsxs)(N.Fragment,{children:[(0,r.jsx)(eu.Separator,{orientation:"vertical",className:"min-h-5 first:hidden"}),(0,r.jsx)(e8.bW,{feature:ey.j.IMAGE,icon:e.icon,title:e.title,description:e.description,canAcceptImages:e.canAcceptImages,isSelected:n===e.mode&&null==e.modelId,modelId:e.modelId,mode:e.mode,onSelect:()=>a(s?q.K.CREATE:e.mode,e.modelId)})]},t)})},t))]})},e9=()=>{let{virtualRef:e}=(0,n.Iq)(),{isOpen:t,closeDialog:a,toggleDialog:l}=(0,C.s)(h.D.IMAGE_SETTING_SELECTOR_MODAL),{isDragging:o}=(0,ew.p)(),{handleImageModeSelect:i}=(0,e4.E)({onSelect:a}),{closeAllDialogsExcept:d}=(0,x.N)(),{formHook:m}=c(),u=(0,s.FH)({control:m.control,name:"mode"}),[p,g]=(0,N.useState)(!1),j=e3[u].icon,v=e3[u].ctaLabel;return(0,N.useEffect)(()=>{let e=setTimeout(()=>{g(o)},0);return()=>clearTimeout(e)},[o]),(0,N.useEffect)(()=>{t&&d([h.D.IMAGE_SETTING_SELECTOR_MODAL])},[d,t]),(0,r.jsxs)(e5.AM,{open:t||o,children:[(0,r.jsx)(e5.dT,{virtualRef:e}),(0,r.jsxs)(ev.$,{variant:"outline",size:"sm",shape:"pill",type:"button",className:"px-1",onClick:l,"data-state":t?"open":"closed",children:[(0,r.jsx)("div",{children:j}),(0,r.jsx)("span",{className:"truncate",children:v})]}),(0,r.jsx)(e5.hl,{className:"rounded-4 group bg-background/60 relative isolate flex w-(--radix-popper-anchor-width) flex-col items-stretch gap-2 overflow-hidden p-3 drop-shadow-md backdrop-blur-md focus:outline-none",side:"top",sideOffset:16,children:(0,r.jsx)(e6,{selected:u,onEscPress:a,onModeSelect:i},p?"force-remount":"normal")})]})},te=()=>(0,r.jsx)(j.kc,{children:(0,r.jsxs)(g.m,{className:"flex flex-col items-stretch gap-4",children:[(0,r.jsx)(G,{}),(0,r.jsx)(I,{}),(0,r.jsx)(H,{})]})}),tt=()=>(0,r.jsx)(j.dn,{initialStack:[{name:"Settings",component:(0,r.jsx)(te,{})}]}),ta=()=>{let{formHook:e}=c(),t=(0,s.FH)({control:e.control,name:"images"}).length>0;return(0,r.jsxs)("div",{className:"laptop:hidden flex items-center gap-2",children:[!t&&(0,r.jsx)(e1,{}),t&&(0,r.jsx)(e7,{}),(0,r.jsx)(eu.Separator,{orientation:"vertical",className:"tablet:hidden min-h-3.5 shrink-0 rounded-full"}),(0,r.jsx)(tt,{})]})},tr=()=>{let{formHook:e}=c(),{computeImageGenerationCost:t}=S(),a=(0,s.FH)({control:e.control,name:"images"}),l=(0,s.FH)({control:e.control,name:"model"}),o=(0,s.FH)({control:e.control,name:"numberOfImages"}),i=(0,ek.O)(e=>e.getLoadingState),d=a.some(e=>i(e.id)),{totalCost:m}=t({modelId:l.modelId,numberOfImages:o});return(0,r.jsx)(n.jW,{cost:m,disabled:d})},tn=()=>{let{formHook:e}=c(),{promptId:t}=(0,n.Iq)();return(0,r.jsx)(l.zB,{control:e.control,name:"prompt",render:a=>{let{field:s}=a;return(0,r.jsx)(n.w6,{id:t,placeholder:"Describe your image",onEnterKeyMetaPress:()=>{e.setValue("shouldRetainPrompt",!0)},...s})}})};var ts=a(91572),tl=a(90807);let to=()=>{let{formHook:e}=c(),t=(0,y.bj)(),{closeAllDialogs:a}=(0,O.I)(),n=(0,s.FH)({control:e.control,name:"model"}),l=(0,s.FH)({control:e.control,name:"preset"}),o=n.presets.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()));return(0,r.jsxs)(tl.b0,{children:[0===o.length&&t&&(0,r.jsxs)("div",{className:"col-span-full m-auto flex size-full flex-col items-center justify-center gap-1.5 text-center",children:[(0,r.jsx)("span",{className:"text-body-lg font-semibold",children:"Try a different search"}),(0,r.jsxs)("span",{className:"text-content-secondary",children:["No results for '",t,"'"]})]}),(0,r.jsx)(ts.i,{columnsCountBreakPoints:{375:2,768:3,1024:4},children:(0,r.jsx)(ts.A,{gutter:"16px",children:o.map(t=>{let n=t.id===(null==l?void 0:l.id),[s,o]=t.aspectRatio.split(":").map(Number);return(0,r.jsx)(tl.jf,{name:t.name,thumbnail:t.thumbnail,isSelected:n,className:"w-full",onClick:()=>{e.setValue("preset",t),a()},style:{aspectRatio:"".concat(s,"/").concat(o)}},t.id)})})})]})},ti=()=>{let{isOpen:e,setDialogOpen:t,closeDialog:a,toggleDialog:n}=(0,C.s)(h.D.IMAGE_PRESET_DIALOG),{closeAllDialogsExcept:l}=(0,x.N)(),{formHook:o}=c(),i=(0,e_.d)(),d=(0,s.FH)({control:o.control,name:"model"}),m=(0,s.FH)({control:o.control,name:"preset"}),u=0===d.presets.length;return((0,N.useEffect)(()=>{e&&l([h.D.IMAGE_PRESET_DIALOG])},[e,l]),u)?null:(0,r.jsxs)(y.YL,{children:[(0,r.jsx)(tl.wE,{isOpen:e,onClick:n,preset:m},null==m?void 0:m.id),(0,r.jsx)(k.vF,{open:e&&i,onOpenChange:t,children:(0,r.jsxs)(k.KZ,{children:[(0,r.jsx)(k.kX,{name:"Preset",closePopover:a}),(0,r.jsx)("div",{className:"size-full overflow-hidden px-4",children:(0,r.jsx)(to,{})})]})}),(0,r.jsx)(ef.Sheet,{open:e&&!i,onOpenChange:t,children:(0,r.jsxs)(j.zE,{className:"h-[calc(100dvh---spacing(20)))]",children:[(0,r.jsx)(j.SJ,{name:"Preset",description:"Configure your generation settings"}),(0,r.jsx)(j.kc,{children:(0,r.jsx)(y.YL,{children:(0,r.jsx)(to,{})})})]})})]})},td=()=>(0,r.jsx)(n.j8,{children:(0,r.jsx)(n.x_,{children:(0,r.jsx)(em,{children:(0,r.jsxs)(n.gn,{children:[(0,r.jsx)(n.ap,{children:(0,r.jsx)(e0,{})}),(0,r.jsxs)(n.At,{children:[(0,r.jsx)(eZ,{}),(0,r.jsx)(e9,{})]}),(0,r.jsx)(n.iF,{}),(0,r.jsxs)(n.d8,{children:[(0,r.jsx)(tn,{}),(0,r.jsxs)(n.Ng,{children:[(0,r.jsx)(ta,{}),(0,r.jsx)(V,{}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(ti,{}),(0,r.jsx)(tr,{})]})]})]})]})})})}),tc=()=>(0,r.jsx)(d,{children:(0,r.jsx)(td,{})})},75567:(e,t,a)=>{"use strict";a.d(t,{N:()=>u,i:()=>p});var r=a(223),n=a.n(r),s=a(65304),l=a(38),o=a(21520),i=a(98357),d=a(20364),c=a(1227),m=a(71874);let u=(e,t)=>Array.from({length:e.count}).map(()=>(0,c.r_)((0,o.OK)({batch_id:t,category:l.em.IMAGE,code:l.WX.PENDING,created_at:n()().toISOString(),updated_at:n()().toISOString(),service:d.z1.IMAGE,endpoint:i.X.GENERATE_IMAGE_ASYNC,id:-1,is_public:!1,status:l.wQ.PENDING,style_id:e.styleId,title:"Untitled",url:{generation:[],inputs:e.images.map(e=>URL.createObjectURL(e)),thumbnail:[]},uuid:(0,s.g)(),settings:{clientVersion:"1",metadata:JSON.stringify({placeholderUuid:t,promptWithoutManipulation:e.metadata.promptWithoutManipulation,presetId:e.metadata.presetId}),prompt:e.prompt,aspect_ratio:e.aspectRatio,style_id:"".concat(e.styleId),is_enhance:e.isEnhance?"1":"0",enhancer_id:e.enhancerId,count:"".concat(e.count)}}))),p=(e,t)=>Array.from({length:1}).map(()=>(0,m.Cf)((0,o.OK)({batch_id:t,category:l.em.IMAGE,code:l.WX.PENDING,created_at:n()().toISOString(),updated_at:n()().toISOString(),service:d.z1.IMAGE,endpoint:i.X.UPSCALE_IMAGE_ASYNC,id:-1,is_public:!1,status:l.wQ.PENDING,style_id:e.styleId,title:"Untitled",url:{generation:[],inputs:[URL.createObjectURL(e.image)],thumbnail:[]},uuid:(0,s.g)(),settings:{style_id:"".concat(e.styleId),clientVersion:"1",metadata:JSON.stringify({placeholderUuid:t,createdFromSettings:e.metadata.createdFromSettings,promptWithoutManipulation:e.metadata.promptWithoutManipulation})}})))},81905:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l});var r=a(20364),n=a(25868),s=a(59761);let l=[[a(90416).n.IMAGE_ASSETS],(0,n.ld)(),(0,n.ld)([r.z1.IMAGE]),[s.e.INFINITE,...(0,n.ld)()],[s.e.INFINITE,...(0,n.ld)([r.z1.IMAGE])]]}},e=>{e.O(0,[3970,6701,8987,7305,5548,2281,5680,2398,6789,3184,8418,2026,7056,3777,9654,3488,587,1902,7358],()=>e(e.s=20526)),_N_E=e.O()}]);